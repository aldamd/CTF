# Jenkins CVE-2024-23897 – File Disclosure PoC

Proof-of-concept exploit for **CVE-2024-23897**, an arbitrary file read vulnerability in the Jenkins CLI.

This script abuses argument file expansion (`@file`) in the Jenkins CLI to leak file contents via verbose commands.

---

## Background

CVE-2024-23897 is an arbitrary file read vulnerability affecting Jenkins’ built-in CLI.

The issue stems from how the CLI expands arguments prefixed with `@`.  
When certain commands are used, Jenkins attempts to interpret the contents of a file as CLI arguments. If the command fails in a predictable way, portions of the file are echoed back in error messages.

Under default configurations, this allows:
- Partial file disclosure  
- Leakage of sensitive files (e.g. `/etc/passwd`)  
- Potential credential extraction (depending on Jenkins configuration)  

This vulnerability was disclosed in January 2024.

### References
- [Jenkins Security Advisory (2024-01-24)](https://www.jenkins.io/security/advisory/2024-01-24/)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)
- [SonarSource Writeup](https://www.sonarsource.com/blog/excessive-expansion-uncovering-critical-security-vulnerabilities-in-jenkins/)

---

## What This PoC Does
1. Downloads `jenkins-cli.jar` from the target  
2. Identifies a verbose CLI command to maximize file leakage
3. Uses `@file` expansion to trigger file disclosure  
4. Parses and prints leaked content cleanly  

> Note: This typically leaks a limited number of lines per execution.

---

## Requirements
- Python 3.8+  
- `requests`  
- Java (required to execute `jenkins-cli.jar`)

---

## Usage

```bash
./poc.py <url> <file>
```

### Example

```bash
./poc.py http://127.0.0.1:8080/ /etc/passwd
```
```text
============================================================
  Jenkins CVE-2024-23897 File Disclosure PoC
============================================================

[+] Target:        http://127.0.0.1:8080/
[+] File:          /etc/passwd
[+] CLI Retrieved: http://127.0.0.1:8080/jnlpJars/jenkins-cli.jar
[+] Verbose Cmd:   connect-node

------------------------------------------------------------
[+] File Contents (/etc/passwd)
------------------------------------------------------------

root:x:0:0:root:/root:/bin/bash
...
```

---

## Affected Versions

At disclosure:

- Jenkins weekly <= 2.441  
- Jenkins LTS <= 2.426.2  

Refer to the official advisory for exact version details.

---

## Disclaimer

This project is provided for educational and research purposes only.

Only test against systems you own or have explicit permission to assess.
